.pragma list(push, 0)
ifndef _NTSECAPI_
define _NTSECAPI_

ifndef _NTDEF_
PNTSTATUS		typedef ptr LONG
endif

ifndef _NTLSA_IFS_
PLSA_OPERATIONAL_MODE	typedef ptr LSA_OPERATIONAL_MODE
endif

LSA_MODE_PASSWORD_PROTECTED	equ 0x00000001
LSA_MODE_INDIVIDUAL_ACCOUNTS	equ 0x00000002
LSA_MODE_MANDATORY_ACCESS	equ 0x00000004
LSA_MODE_LOG_FULL		equ 0x00000008

ifndef _NTLSA_IFS_
SECURITY_LOGON_TYPE	typedef SDWORD
Interactive		equ 2
Network			equ 1
Batch			equ 2
Service			equ 3
Proxy			equ 4
Unlock			equ 5
endif

POLICY_AUDIT_EVENT_TYPE typedef SDWORD
AuditCategorySystem		equ 0
AuditCategoryLogon		equ 1
AuditCategoryObjectAccess	equ 2
AuditCategoryPrivilegeUse	equ 3
AuditCategoryDetailedTracking	equ 4
AuditCategoryPolicyChange	equ 5
AuditCategoryAccountManagement	equ 6
AuditCategoryDirectoryServiceAccess equ 7
AuditCategoryAccountLogon	equ 8

POLICY_AUDIT_EVENT_UNCHANGED	equ 0x00000000
POLICY_AUDIT_EVENT_SUCCESS	equ 0x00000001
POLICY_AUDIT_EVENT_FAILURE	equ 0x00000002
POLICY_AUDIT_EVENT_NONE		equ 0x00000004
POLICY_AUDIT_EVENT_MASK equ POLICY_AUDIT_EVENT_SUCCESS or POLICY_AUDIT_EVENT_FAILURE or POLICY_AUDIT_EVENT_UNCHANGED


ifdef _NTDEF_
PLSA_UNICODE_STRING	typedef ptr LSA_UNICODE_STRING
PLSA_STRING		typedef ptr LSA_STRING
PLSA_OBJECT_ATTRIBUTES	typedef ptr LSA_OBJECT_ATTRIBUTES
else

LSA_UNICODE_STRING	STRUC
Length			USHORT ?
MaximumLength		USHORT ?
Buffer			PWSTR ?
LSA_UNICODE_STRING	ENDS
PLSA_UNICODE_STRING	typedef ptr LSA_UNICODE_STRING

LSA_STRING		STRUC
Length			USHORT ?
MaximumLength		USHORT ?
Buffer			PCHAR ?
LSA_STRING		ENDS
PLSA_STRING		typedef ptr LSA_STRING

LSA_OBJECT_ATTRIBUTES	STRUC
Length			ULONG ?
RootDirectory		HANDLE ?
ObjectName		PLSA_UNICODE_STRING ?
Attributes		ULONG ?
SecurityDescriptor	PVOID ? ;; Points to type SECURITY_DESCRIPTOR
SecurityQualityOfService PVOID ?	;; Points to type SECURITY_QUALITY_OF_SERVICE
LSA_OBJECT_ATTRIBUTES	ENDS
PLSA_OBJECT_ATTRIBUTES	typedef ptr LSA_OBJECT_ATTRIBUTES

endif ;; _NTDEF_

LSA_SUCCESS macro Error
	exitm<((Error) GE 0)>
	endm

ifndef _NTLSA_IFS_

;NTAPI
LsaRegisterLogonProcess proto WINAPI \
      LogonProcessName: PLSA_STRING,
	     LsaHandle: PHANDLE,
	  SecurityMode: PLSA_OPERATIONAL_MODE

LsaLogonUser proto WINAPI \
	     LsaHandle: HANDLE,
	    OriginName: PLSA_STRING,
	     LogonType: SECURITY_LOGON_TYPE,
 AuthenticationPackage: ULONG,
AuthenticationInformation: PVOID,
AuthenticationInformationLength: ULONG,
  LocalGroups OPTIONAL: PTOKEN_GROUPS,
	 SourceContext: PTOKEN_SOURCE,
	 ProfileBuffer: ptr PVOID,
   ProfileBufferLength: PULONG,
	       LogonId: PLUID,
		 Token: PHANDLE,
		Quotas: PQUOTA_LIMITS,
	     SubStatus: PNTSTATUS

LsaLookupAuthenticationPackage proto WINAPI \
	     LsaHandle: HANDLE,
	   PackageName: PLSA_STRING,
 AuthenticationPackage: PULONG

LsaFreeReturnBuffer proto WINAPI \
		Buffer: PVOID

LsaCallAuthenticationPackage proto WINAPI \
	     LsaHandle: HANDLE,
 AuthenticationPackage: ULONG,
  ProtocolSubmitBuffer: PVOID,
    SubmitBufferLength: ULONG,
  ProtocolReturnBuffer: ptr PVOID,
    ReturnBufferLength: PULONG,
	ProtocolStatus: PNTSTATUS

LsaDeregisterLogonProcess proto WINAPI \
	     LsaHandle: HANDLE

LsaConnectUntrusted proto WINAPI \
	     LsaHandle: PHANDLE

endif ;; _NTLSA_IFS_

POLICY_MACHINE_POLICY_LOCAL equ 0x0
POLICY_MACHINE_POLICY_DEFAULTED equ 0x1
POLICY_MACHINE_POLICY_EXPLICIT equ 0x2
POLICY_MACHINE_POLICY_UNKNOWN equ 0xFFFFFFFF	  ;; Internal flag only

POLICY_VIEW_LOCAL_INFORMATION equ 0x00000001
POLICY_VIEW_AUDIT_INFORMATION equ 0x00000002
POLICY_GET_PRIVATE_INFORMATION equ 0x00000004
POLICY_TRUST_ADMIN	equ 0x00000008
POLICY_CREATE_ACCOUNT	equ 0x00000010
POLICY_CREATE_SECRET	equ 0x00000020
POLICY_CREATE_PRIVILEGE equ 0x00000040
POLICY_SET_DEFAULT_QUOTA_LIMITS equ 0x00000080
POLICY_SET_AUDIT_REQUIREMENTS equ 0x00000100
POLICY_AUDIT_LOG_ADMIN	equ 0x00000200
POLICY_SERVER_ADMIN	equ 0x00000400
POLICY_LOOKUP_NAMES	equ 0x00000800

POLICY_ALL_ACCESS	equ (STANDARD_RIGHTS_REQUIRED OR \
			     POLICY_VIEW_LOCAL_INFORMATION OR \
			     POLICY_VIEW_AUDIT_INFORMATION OR \
			     POLICY_GET_PRIVATE_INFORMATION OR \
			     POLICY_TRUST_ADMIN OR \
			     POLICY_CREATE_ACCOUNT OR \
			     POLICY_CREATE_SECRET OR \
			     POLICY_CREATE_PRIVILEGE OR \
			     POLICY_SET_DEFAULT_QUOTA_LIMITS OR \
			     POLICY_SET_AUDIT_REQUIREMENTS OR \
			     POLICY_AUDIT_LOG_ADMIN OR \
			     POLICY_SERVER_ADMIN OR \
			     POLICY_LOOKUP_NAMES)

POLICY_READ		equ STANDARD_RIGHTS_READ OR POLICY_VIEW_AUDIT_INFORMATION

POLICY_WRITE		equ (STANDARD_RIGHTS_WRITE OR \
			     POLICY_TRUST_ADMIN OR \
			     POLICY_CREATE_ACCOUNT OR \
			     POLICY_CREATE_SECRET OR \
			     POLICY_CREATE_PRIVILEGE OR \
			     POLICY_SET_DEFAULT_QUOTA_LIMITS OR \
			     POLICY_SET_AUDIT_REQUIREMENTS OR \
			     POLICY_AUDIT_LOG_ADMIN)

POLICY_EXECUTE		equ (STANDARD_RIGHTS_EXECUTE OR POLICY_VIEW_LOCAL_INFORMATION OR POLICY_LOOKUP_NAMES)


LSA_TRUST_INFORMATION	STRUC
Name			LSA_UNICODE_STRING <>
Sid			PSID ?
LSA_TRUST_INFORMATION	ENDS
PLSA_TRUST_INFORMATION	typedef ptr LSA_TRUST_INFORMATION

LSA_REFERENCED_DOMAIN_LIST STRUC
Entries			ULONG ?
Domains			PLSA_TRUST_INFORMATION ?
LSA_REFERENCED_DOMAIN_LIST ENDS
PLSA_REFERENCED_DOMAIN_LIST typedef ptr LSA_REFERENCED_DOMAIN_LIST

LSA_TRANSLATED_SID	STRUC
Use			SID_NAME_USE ?
RelativeId		ULONG ?
DomainIndex		LONG ?
LSA_TRANSLATED_SID	ENDS
PLSA_TRANSLATED_SID	typedef ptr LSA_TRANSLATED_SID

LSA_TRANSLATED_NAME	STRUC
Use			SID_NAME_USE ?
Name			LSA_UNICODE_STRING <>
DomainIndex		LONG ?
LSA_TRANSLATED_NAME	ENDS
PLSA_TRANSLATED_NAME	typedef ptr LSA_TRANSLATED_NAME

POLICY_LSA_SERVER_ROLE	typedef SDWORD
PolicyServerRoleBackup	equ 2
PolicyServerRolePrimary equ 1

POLICY_SERVER_ENABLE_STATE typedef SDWORD
PolicyServerEnabled	equ 2
PolicyServerDisabled	equ 1

PPOLICY_AUDIT_EVENT_OPTIONS typedef ptr ULONG ;POLICY_AUDIT_EVENT_OPTIONS

POLICY_PRIVILEGE_DEFINITION STRUC
Name			LSA_UNICODE_STRING <>
LocalValue		LUID <>
POLICY_PRIVILEGE_DEFINITION ENDS
PPOLICY_PRIVILEGE_DEFINITION typedef ptr POLICY_PRIVILEGE_DEFINITION

POLICY_INFORMATION_CLASS typedef SDWORD
PolicyAuditLogInformation equ 1
PolicyAuditEventsInformation equ 1
PolicyPrimaryDomainInformation equ 2
PolicyPdAccountInformation equ 3
PolicyAccountDomainInformation equ 4
PolicyLsaServerRoleInformation equ 5
PolicyReplicaSourceInformation equ 6
PolicyDefaultQuotaInformation equ 7
PolicyModificationInformation equ 8
PolicyAuditFullSetInformation equ 9
PolicyAuditFullQueryInformation equ 10
PolicyDnsDomainInformation equ 11
PolicyEfsInformation	equ 12

POLICY_AUDIT_LOG_INFO	STRUC
AuditLogPercentFull	ULONG ?
MaximumLogSize		ULONG ?
AuditRetentionPeriod	LARGE_INTEGER <>
AuditLogFullShutdownInProgress BOOLEAN ?
TimeToShutdown		LARGE_INTEGER <>
NextAuditRecordId	ULONG ?
POLICY_AUDIT_LOG_INFO	ENDS
PPOLICY_AUDIT_LOG_INFO	typedef ptr POLICY_AUDIT_LOG_INFO

POLICY_AUDIT_EVENTS_INFO  STRUC
AuditingMode		BOOLEAN ?
EventAuditingOptions	PPOLICY_AUDIT_EVENT_OPTIONS ?
MaximumAuditEventCount	ULONG ?
POLICY_AUDIT_EVENTS_INFO ENDS
PPOLICY_AUDIT_EVENTS_INFO typedef ptr POLICY_AUDIT_EVENTS_INFO

POLICY_ACCOUNT_DOMAIN_INFO  STRUC
DomainName		LSA_UNICODE_STRING <>
DomainSid		PSID ?
POLICY_ACCOUNT_DOMAIN_INFO ENDS
PPOLICY_ACCOUNT_DOMAIN_INFO typedef ptr POLICY_ACCOUNT_DOMAIN_INFO

POLICY_PRIMARY_DOMAIN_INFO  STRUC
Name			LSA_UNICODE_STRING <>
Sid			PSID ?
POLICY_PRIMARY_DOMAIN_INFO ENDS
PPOLICY_PRIMARY_DOMAIN_INFO typedef ptr POLICY_PRIMARY_DOMAIN_INFO

POLICY_DNS_DOMAIN_INFO	STRUC
Name			LSA_UNICODE_STRING <>
DnsDomainName		LSA_UNICODE_STRING <>
DnsTreeName		LSA_UNICODE_STRING <>
DomainGuid		GUID <>
Sid			PSID ?
POLICY_DNS_DOMAIN_INFO	ENDS
PPOLICY_DNS_DOMAIN_INFO typedef ptr POLICY_DNS_DOMAIN_INFO

POLICY_PD_ACCOUNT_INFO	STRUC
Name			LSA_UNICODE_STRING <>
POLICY_PD_ACCOUNT_INFO	ENDS
PPOLICY_PD_ACCOUNT_INFO typedef ptr POLICY_PD_ACCOUNT_INFO

POLICY_LSA_SERVER_ROLE_INFO  STRUC
LsaServerRole		POLICY_LSA_SERVER_ROLE ?
POLICY_LSA_SERVER_ROLE_INFO ENDS
PPOLICY_LSA_SERVER_ROLE_INFO typedef ptr POLICY_LSA_SERVER_ROLE_INFO

POLICY_REPLICA_SOURCE_INFO  STRUC
ReplicaSource		LSA_UNICODE_STRING <>
ReplicaAccountName	LSA_UNICODE_STRING <>
POLICY_REPLICA_SOURCE_INFO ENDS
PPOLICY_REPLICA_SOURCE_INFO typedef ptr POLICY_REPLICA_SOURCE_INFO

POLICY_DEFAULT_QUOTA_INFO  STRUC
QuotaLimits		QUOTA_LIMITS <>
POLICY_DEFAULT_QUOTA_INFO ENDS
PPOLICY_DEFAULT_QUOTA_INFO typedef ptr POLICY_DEFAULT_QUOTA_INFO

POLICY_MODIFICATION_INFO  STRUC
ModifiedId		LARGE_INTEGER <>
DatabaseCreationTime	LARGE_INTEGER <>
POLICY_MODIFICATION_INFO ENDS
PPOLICY_MODIFICATION_INFO typedef ptr POLICY_MODIFICATION_INFO

POLICY_AUDIT_FULL_SET_INFO  STRUC
ShutDownOnFull		BOOLEAN ?
POLICY_AUDIT_FULL_SET_INFO ENDS
PPOLICY_AUDIT_FULL_SET_INFO typedef ptr POLICY_AUDIT_FULL_SET_INFO

POLICY_AUDIT_FULL_QUERY_INFO  STRUC
ShutDownOnFull		BOOLEAN ?
LogIsFull		BOOLEAN ?
POLICY_AUDIT_FULL_QUERY_INFO ENDS
PPOLICY_AUDIT_FULL_QUERY_INFO typedef ptr POLICY_AUDIT_FULL_QUERY_INFO

POLICY_EFS_INFO		STRUC
InfoLength		ULONG ?
EfsBlob			PUCHAR ?
POLICY_EFS_INFO		ENDS
PPOLICY_EFS_INFO	typedef ptr POLICY_EFS_INFO

POLICY_LOCAL_INFORMATION_CLASS typedef SDWORD
PolicyLocalAuditEventsInformation equ 1
PolicyLocalPdAccountInformation equ 1
PolicyLocalAccountDomainInformation equ 2
PolicyLocalLsaServerRoleInformation equ 3
PolicyLocalReplicaSourceInformation equ 4
PolicyLocalModificationInformation equ 5
PolicyLocalAuditFullSetInformation equ 6
PolicyLocalAuditFullQueryInformation equ 7
PolicyLocalDnsDomainInformation equ 8
PolicyLocalIPSecReferenceInformation equ 9
PolicyLocalMachinePasswordInformation equ 10
PolicyLocalQualityOfServiceInformation equ 11
PolicyLocalPolicyLocationInformation equ 12

POLICY_LOCAL_IPSEC_REFERENCE_INFO  STRUC
ObjectPath		LSA_UNICODE_STRING <>
POLICY_LOCAL_IPSEC_REFERENCE_INFO ENDS
PPOLICY_LOCAL_IPSEC_REFERENCE_INFO typedef ptr POLICY_LOCAL_IPSEC_REFERENCE_INFO

POLICY_LOCAL_MACHINE_PASSWORD_INFO  STRUC
PasswordChangeInterval	LARGE_INTEGER <>
POLICY_LOCAL_MACHINE_PASSWORD_INFO ENDS
PPOLICY_LOCAL_MACHINE_PASSWORD_INFO typedef ptr POLICY_LOCAL_MACHINE_PASSWORD_INFO

POLICY_LOCATION_LOCAL	equ 1
POLICY_LOCATION_DS	equ 2

POLICY_LOCAL_POLICY_LOCATION_INFO  STRUC
PolicyLocation		ULONG ?
POLICY_LOCAL_POLICY_LOCATION_INFO ENDS
PPOLICY_LOCAL_POLICY_LOCATION_INFO typedef ptr POLICY_LOCAL_POLICY_LOCATION_INFO

POLICY_QOS_SCHANEL_REQUIRED equ 0x00000001
POLICY_QOS_OUTBOUND_INTEGRITY equ 0x00000002
POLICY_QOS_OUTBOUND_CONFIDENTIALITY equ 0x00000004
POLICY_QOS_INBOUND_INTEGREITY equ 0x00000008
POLICY_QOS_INBOUND_CONFIDENTIALITY equ 0x00000010
POLICY_QOS_ALLOW_LOCAL_ROOT_CERT_STORE equ 0x00000020
POLICY_QOS_RAS_SERVER_ALLOWED equ 0x00000040
POLICY_QOS_DHCP_SERVER_ALLOWD equ 0x00000080

POLICY_LOCAL_QUALITY_OF_SERVICE_INFO STRUC
QualityOfService	ULONG ?
POLICY_LOCAL_QUALITY_OF_SERVICE_INFO ENDS
PPOLICY_LOCAL_QUALITY_OF_SERVICE_INFO typedef ptr POLICY_LOCAL_QUALITY_OF_SERVICE_INFO

POLICY_DOMAIN_INFORMATION_CLASS typedef SDWORD
PolicyDomainIPSecReferenceInformation equ 1
PolicyDomainQualityOfServiceInformation equ 1
PolicyDomainEfsInformation equ 2
PolicyDomainPublicKeyInformation equ 3
PolicyDomainPasswordPolicyInformation equ 4
PolicyDomainLockoutInformation equ 5
PolicyDomainKerberosTicketInformation equ 6

POLICY_DOMAIN_QUALITY_OF_SERVICE_INFO typedef POLICY_LOCAL_QUALITY_OF_SERVICE_INFO
PPOLICY_DOMAIN_QUALITY_OF_SERVICE_INFO typedef ptr POLICY_LOCAL_QUALITY_OF_SERVICE_INFO

POLICY_DOMAIN_PUBLIC_KEY_INFO  STRUC
InfoLength		ULONG ?
PublicKeyInfo		PUCHAR ?
POLICY_DOMAIN_PUBLIC_KEY_INFO ENDS
PPOLICY_DOMAIN_PUBLIC_KEY_INFO typedef ptr POLICY_DOMAIN_PUBLIC_KEY_INFO

POLICY_DOMAIN_LOCKOUT_INFO  STRUC
LockoutDuration		LARGE_INTEGER <>
LockoutObservationWindow LARGE_INTEGER <>
LockoutThreshold	USHORT ?
POLICY_DOMAIN_LOCKOUT_INFO ENDS
PPOLICY_DOMAIN_LOCKOUT_INFO typedef ptr POLICY_DOMAIN_LOCKOUT_INFO

POLICY_DOMAIN_PASSWORD_INFO  STRUC
MinPasswordLength	USHORT ?
PasswordHistoryLength	USHORT ?
PasswordProperties	ULONG ?
MaxPasswordAge		LARGE_INTEGER <>
MinPasswordAge		LARGE_INTEGER <>
POLICY_DOMAIN_PASSWORD_INFO ENDS
PPOLICY_DOMAIN_PASSWORD_INFO typedef ptr POLICY_DOMAIN_PASSWORD_INFO

POLICY_KERBEROS_FORWARDABLE equ 0x00000001
POLICY_KERBEROS_PROXYABLE equ 0x00000002
POLICY_KERBEROS_RENEWABLE equ 0x00000004
POLICY_KERBEROS_POSTDATEABLE equ 0x00000008
POLICY_DOMAIN_KERBEROS_TICKET_INFO  STRUC

AuthenticationOptions	ULONG ?
MinTicketAge		LARGE_INTEGER <>
MaxTicketAge		LARGE_INTEGER <>
MaxRenewAge		LARGE_INTEGER <>
ProxyLifetime		LARGE_INTEGER <>
ForceLogoff		LARGE_INTEGER <>
POLICY_DOMAIN_KERBEROS_TICKET_INFO ENDS
PPOLICY_DOMAIN_KERBEROS_TICKET_INFO typedef ptr POLICY_DOMAIN_KERBEROS_TICKET_INFO

PLSA_HANDLE		typedef ptr LSA_HANDLE

TRUSTED_INFORMATION_CLASS typedef SDWORD
TrustedDomainNameInformation equ 1
TrustedControllersInformation equ 1
TrustedPosixOffsetInformation equ 2
TrustedPasswordInformation equ 3
TrustedDomainInformationBasic equ 4
TrustedDomainInformationEx equ 5
TrustedDomainAuthInformation equ 6
TrustedDomainFullInformation equ 7

TRUSTED_DOMAIN_NAME_INFO  STRUC
Name			LSA_UNICODE_STRING <>
TRUSTED_DOMAIN_NAME_INFO ENDS
PTRUSTED_DOMAIN_NAME_INFO typedef ptr TRUSTED_DOMAIN_NAME_INFO

TRUSTED_CONTROLLERS_INFO  STRUC
Entries			ULONG ?
Names			PLSA_UNICODE_STRING ?
TRUSTED_CONTROLLERS_INFO ENDS
PTRUSTED_CONTROLLERS_INFO typedef ptr TRUSTED_CONTROLLERS_INFO

TRUSTED_POSIX_OFFSET_INFO  STRUC
_Offset			ULONG ?
TRUSTED_POSIX_OFFSET_INFO ENDS
PTRUSTED_POSIX_OFFSET_INFO typedef ptr TRUSTED_POSIX_OFFSET_INFO

TRUSTED_PASSWORD_INFO	STRUC
Password		LSA_UNICODE_STRING <>
OldPassword		LSA_UNICODE_STRING <>
TRUSTED_PASSWORD_INFO	ENDS
PTRUSTED_PASSWORD_INFO	typedef ptr TRUSTED_PASSWORD_INFO

TRUSTED_DOMAIN_INFORMATION_BASIC typedef  LSA_TRUST_INFORMATION
PTRUSTED_DOMAIN_INFORMATION_BASIC typedef ptr PLSA_TRUST_INFORMATION

TRUST_DIRECTION_DISABLED	equ 0x00000000
TRUST_DIRECTION_INBOUND		equ 0x00000001
TRUST_DIRECTION_OUTBOUND	equ 0x00000002
TRUST_DIRECTION_BIDIRECTIONAL	equ (TRUST_DIRECTION_INBOUND OR TRUST_DIRECTION_OUTBOUND)
TRUST_TYPE_DOWNLEVEL		equ 0x00000001
TRUST_TYPE_UPLEVEL		equ 0x00000002
TRUST_TYPE_MIT			equ 0x00000003
TRUST_TYPE_DCE			equ 0x00000004
TRUST_ATTRIBUTE_NON_TRANSITIVE	equ 0x00000001
TRUST_ATTRIBUTE_UPLEVEL_ONLY	equ 0x00000002
TRUST_ATTRIBUTE_TREE_PARENT	equ 0x00400000
TRUST_ATTRIBUTES_VALID		equ 0xFF02FFFF


TRUSTED_DOMAIN_INFORMATION_EX  STRUC
Name			LSA_UNICODE_STRING <>
FlatName		LSA_UNICODE_STRING <>
Sid			PSID ?
TrustDirection		ULONG ?
TrustType		ULONG ?
TrustAttributes		ULONG ?
TRUSTED_DOMAIN_INFORMATION_EX ENDS
PTRUSTED_DOMAIN_INFORMATION_EX typedef ptr TRUSTED_DOMAIN_INFORMATION_EX

TRUST_AUTH_TYPE_NONE	equ 0
TRUST_AUTH_TYPE_NT4OWF	equ 1
TRUST_AUTH_TYPE_CLEAR	equ 2

LSA_AUTH_INFORMATION	STRUC
LastUpdateTime		LARGE_INTEGER <>
AuthType		ULONG ?
AuthInfoLength		ULONG ?
AuthInfo		PUCHAR ?
LSA_AUTH_INFORMATION	ENDS
PLSA_AUTH_INFORMATION	typedef ptr LSA_AUTH_INFORMATION

TRUSTED_DOMAIN_AUTH_INFORMATION STRUC
IncomingAuthInfos	ULONG ?
IncomingAuthenticationInformation PLSA_AUTH_INFORMATION ?
IncomingPreviousAuthenticationInformation PLSA_AUTH_INFORMATION ?
OutgoingAuthInfos	ULONG ?
OutgoingAuthenticationInformation PLSA_AUTH_INFORMATION ?
OutgoingPreviousAuthenticationInformation PLSA_AUTH_INFORMATION ?
TRUSTED_DOMAIN_AUTH_INFORMATION ENDS
PTRUSTED_DOMAIN_AUTH_INFORMATION typedef ptr TRUSTED_DOMAIN_AUTH_INFORMATION

TRUSTED_DOMAIN_FULL_INFORMATION STRUC
Information		TRUSTED_DOMAIN_INFORMATION_EX <>
PosixOffset		TRUSTED_POSIX_OFFSET_INFO <>
AuthInformation		TRUSTED_DOMAIN_AUTH_INFORMATION <>
TRUSTED_DOMAIN_FULL_INFORMATION ENDS
PTRUSTED_DOMAIN_FULL_INFORMATION typedef ptr TRUSTED_DOMAIN_FULL_INFORMATION

PLSA_ENUMERATION_HANDLE typedef ptr ULONG ;LSA_ENUMERATION_HANDLE

LSA_ENUMERATION_INFORMATION STRUC
Sid			PSID ?
LSA_ENUMERATION_INFORMATION ENDS
PLSA_ENUMERATION_INFORMATION typedef ptr LSA_ENUMERATION_INFORMATION


;NTAPI
LsaFreeMemory proto WINAPI \
		Buffer: PVOID

LsaClose proto WINAPI \
	  ObjectHandle: LSA_HANDLE

LsaOpenPolicy proto WINAPI \
   SystemName OPTIONAL: PLSA_UNICODE_STRING,
      ObjectAttributes: PLSA_OBJECT_ATTRIBUTES,
	 DesiredAccess: ACCESS_MASK,
	  PolicyHandle: PLSA_HANDLE

LsaQueryInformationPolicy proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
      InformationClass: POLICY_INFORMATION_CLASS,
		Buffer: ptr PVOID

LsaSetInformationPolicy proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
      InformationClass: POLICY_INFORMATION_CLASS,
		Buffer: PVOID

LsaQueryLocalInformationPolicy proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
      InformationClass: POLICY_LOCAL_INFORMATION_CLASS,
		Buffer: ptr PVOID

LsaSetLocalInformationPolicy proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
      InformationClass: POLICY_LOCAL_INFORMATION_CLASS,
		Buffer: PVOID

LsaQueryDomainInformationPolicy proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
      InformationClass: POLICY_DOMAIN_INFORMATION_CLASS,
		Buffer: ptr PVOID

LsaSetDomainInformationPolicy proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
      InformationClass: POLICY_DOMAIN_INFORMATION_CLASS,
		Buffer: PVOID

LsaEnumerateTrustedDomains proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
    EnumerationContext: PLSA_ENUMERATION_HANDLE,
		Buffer: ptr PVOID,
 PreferedMaximumLength: ULONG,
	 CountReturned: PULONG

LsaLookupNames proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
		 Count: ULONG,
		 Names: PLSA_UNICODE_STRING,
     ReferencedDomains: ptr PLSA_REFERENCED_DOMAIN_LIST,
		  Sids: ptr PLSA_TRANSLATED_SID

LsaLookupSids proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
		 Count: ULONG,
		  Sids: ptr PSID,
     ReferencedDomains: ptr PLSA_REFERENCED_DOMAIN_LIST,
		 Names: ptr PLSA_TRANSLATED_NAME


SE_INTERACTIVE_LOGON_NAME equ TEXT("SeInteractiveLogonRight")
SE_NETWORK_LOGON_NAME	equ TEXT("SeNetworkLogonRight")
SE_BATCH_LOGON_NAME	equ TEXT("SeBatchLogonRight")
SE_SERVICE_LOGON_NAME	equ TEXT("SeServiceLogonRight")

;NTAPI
LsaEnumerateAccountsWithUserRight proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
	    UserRights: PLSA_UNICODE_STRING,
     EnumerationBuffer: ptr PVOID,
	 CountReturned: PULONG

LsaEnumerateAccountRights proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
	    AccountSid: PSID,
	    UserRights: ptr PLSA_UNICODE_STRING,
	 CountOfRights: PULONG

LsaAddAccountRights proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
	    AccountSid: PSID,
	    UserRights: PLSA_UNICODE_STRING,
	 CountOfRights: ULONG

LsaRemoveAccountRights proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
	    AccountSid: PSID,
	     AllRights: BOOLEAN,
	    UserRights: PLSA_UNICODE_STRING,
	 CountOfRights: ULONG

LsaQueryTrustedDomainInfo proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
      TrustedDomainSid: PSID,
      InformationClass: TRUSTED_INFORMATION_CLASS,
		Buffer: ptr PVOID

LsaSetTrustedDomainInformation proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
      TrustedDomainSid: PSID,
      InformationClass: TRUSTED_INFORMATION_CLASS,
		Buffer: PVOID

LsaDeleteTrustedDomain proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
      TrustedDomainSid: PSID

LsaQueryTrustedDomainInfoByName proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
     TrustedDomainName: PLSA_UNICODE_STRING,
      InformationClass: TRUSTED_INFORMATION_CLASS,
		Buffer: ptr PVOID

LsaSetTrustedDomainInfoByName proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
     TrustedDomainName: PLSA_UNICODE_STRING,
      InformationClass: TRUSTED_INFORMATION_CLASS,
		Buffer: PVOID

LsaEnumerateTrustedDomainsEx proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
    EnumerationContext: PLSA_ENUMERATION_HANDLE,
      InformationClass: TRUSTED_INFORMATION_CLASS,
		Buffer: ptr PVOID,
 PreferedMaximumLength: ULONG,
	 CountReturned: PULONG

LsaCreateTrustedDomainEx proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
TrustedDomainInformation: PTRUSTED_DOMAIN_INFORMATION_EX,
AuthenticationInformation: PTRUSTED_DOMAIN_AUTH_INFORMATION,
	 DesiredAccess: ACCESS_MASK,
   TrustedDomainHandle: PLSA_HANDLE


LsaStorePrivateData proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
	       KeyName: PLSA_UNICODE_STRING,
	   PrivateData: PLSA_UNICODE_STRING

LsaRetrievePrivateData proto WINAPI \
	  PolicyHandle: LSA_HANDLE,
	       KeyName: PLSA_UNICODE_STRING,
	   PrivateData: ptr PLSA_UNICODE_STRING

LsaNtStatusToWinError proto WINAPI \
		Status: NTSTATUS


ifndef _NTLSA_IFS_
_NTLSA_IFS_ equ 1
endif

ifndef _NTDEF_
PUNICODE_STRING		typedef ptr LSA_UNICODE_STRING
endif

CALLBACK(PSAM_PASSWORD_NOTIFICATION_ROUTINE, \
	:PUNICODE_STRING, :ULONG, :PUNICODE_STRING)

SAM_PASSWORD_CHANGE_NOTIFY_ROUTINE equ <"PasswordChangeNotify">

CALLBACK(PSAM_INIT_NOTIFICATION_ROUTINE)

SAM_INIT_NOTIFICATION_ROUTINE equ <"InitializeChangeNotify">
SAM_PASSWORD_FILTER_ROUTINE equ <"PasswordFilter">

CALLBACK(PSAM_PASSWORD_FILTER_ROUTINE, \
	:PUNICODE_STRING, :PUNICODE_STRING, :PUNICODE_STRING, :BOOLEAN)


endif ;; _NTSECAPI_
.pragma list(pop)
